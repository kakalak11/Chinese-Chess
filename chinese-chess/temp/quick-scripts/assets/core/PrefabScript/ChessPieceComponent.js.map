{"version":3,"sources":["ChessPieceComponent.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../assets/core/PrefabScript","sourcesContent":["const { ccclass, property } = cc._decorator;\n\nconst CONFIG = {\n    TWEEN_TIME: 0.2,\n    SELECT_SCALE: 1.3,\n    DESELECT_SCALE: 1,\n};\n\n@ccclass\nexport default class ChessPieceComponent extends cc.Component {\n    @property(cc.Sprite)\n    sprite: cc.Sprite = null;\n\n    @property(cc.Label)\n    label: cc.Label = null;\n\n    // @property(cc.Node)\n    // overlay: cc.Node = null;\n\n    // @property(cc.Node)\n    // eventNode: cc.Node = null;\n\n    isSelected: boolean;\n    _tweenUnselect: cc.Tween;\n    _tweenSelect: cc.Tween;\n    _tweenHighlight: cc.Tween;\n\n    protected onLoad(): void {\n        (this.node as any).init = this.init.bind(this);\n        (this.node as any).unselect = this.unselect.bind(this);\n        (this.node as any).onMouseLeave = this.onMouseLeave.bind(this);\n        (this.node as any).sprite = this.sprite.node;\n        (this.node as any).isSelected = this.isSelected;\n\n        if (this.node) {\n            this.node.on(cc.Node.EventType.MOUSE_ENTER, this.onMouseEnter, this);\n            this.node.on(cc.Node.EventType.MOUSE_LEAVE, this.onMouseLeave, this);\n            this.node.on(cc.Node.EventType.MOUSE_DOWN, this.onMouseDown, this);\n            this.node.on(cc.Node.EventType.MOUSE_UP, this.onMouseUp, this);\n        }\n\n        this.node.on('RESET', this.reset, this);\n    }\n\n    private init({ name }, shortName, chessSize): void {\n        (this.node as any).chessName = shortName;\n        (this.node as any).fullName = name;\n        this.label.string = shortName;\n\n        this.node.setContentSize(chessSize, chessSize);\n        this.sprite.node.setContentSize(chessSize, chessSize);\n    };\n\n    onMouseEnter() {\n        if (this.isSelected) return;\n        if (this._tweenUnselect) this._tweenUnselect.stop();\n        if (!this._tweenSelect) {\n            this._tweenSelect = cc.tween(this.sprite.node)\n                .to(CONFIG.TWEEN_TIME, { scale: CONFIG.SELECT_SCALE })\n        }\n        this._tweenSelect.start();\n    };\n\n    onMouseLeave() {\n        if (this.isSelected) return;\n        if (this._tweenSelect) this._tweenSelect.stop();\n        if (!this._tweenUnselect) {\n            this._tweenUnselect = cc.tween(this.sprite.node)\n                .to(CONFIG.TWEEN_TIME, { scale: CONFIG.DESELECT_SCALE })\n        }\n        this._tweenUnselect.start();\n    };\n\n    onMouseDown() {\n        if (this.isSelected) {\n            this.isSelected = false;\n            this.onMouseLeave();\n            const unselectEvent = new cc.Event.EventCustom('CHESS_UNSELECT', true);\n\n            this.node.dispatchEvent(unselectEvent);\n            return;\n        }\n        if (!this._tweenHighlight) {\n            this._tweenHighlight = cc.tween(this.sprite.node)\n                .to(CONFIG.TWEEN_TIME / 2, { scale: CONFIG.DESELECT_SCALE })\n                .to(CONFIG.TWEEN_TIME / 2, { scale: CONFIG.SELECT_SCALE })\n        }\n        this._tweenHighlight.start();\n        this.isSelected = true;\n    };\n\n    onMouseUp() {\n        if (!this.isSelected) return;\n        const selectEvent = new cc.Event.EventCustom('CHESS_SELECT', true);\n        (selectEvent as any).chessName = (this.node as any).chessName;\n        (selectEvent as any).side = this.node.parent.name === 'Top_side' ? 'top' : 'bot';\n\n        this.node.dispatchEvent(selectEvent);\n    };\n\n    unselect() {\n        this.isSelected = false;\n    }\n\n    reset() {\n        this.isSelected = null;\n        this._tweenUnselect.start();\n    };\n};"]}