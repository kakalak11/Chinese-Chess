{"version":3,"sources":["../../../../assets/core/assets/core/ChessPiece.js"],"names":["require","init","CONFIG","TWEEN_TIME","SELECT_SCALE","DESELECT_SCALE","cc","Class","extends","Component","properties","sprite","Sprite","label","Label","onLoad","node","bind","on","Node","EventType","MOUSE_ENTER","onMouseEnter","MOUSE_LEAVE","onMouseLeave","MOUSE_DOWN","onMouseDown","MOUSE_UP","onMouseUp","reset","shortName","chessSize","name","chessName","fullName","string","setContentSize","isSelected","_tweenUnselect","stop","_tweenSelect","tween","to","scale","start","unselectEvent","Event","EventCustom","dispatchEvent","_tweenHighlight","selectEvent","side","parent"],"mappings":"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","file":"ChessPiece.js","sourceRoot":"../../../../assets/core","sourcesContent":["const { init } = require(\"events\");\n\nconst CONFIG = {\n    TWEEN_TIME: 0.2,\n    SELECT_SCALE: 1.3,\n    DESELECT_SCALE: 1,\n};\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        sprite: cc.Sprite,\n        label: cc.Label,\n    },\n\n    onLoad() {\n        this.node.init = this.init.bind(this);\n        this.node.sprite = this.sprite.node;\n\n        if (this.node) {\n            this.node.on(cc.Node.EventType.MOUSE_ENTER, this.onMouseEnter, this);\n            this.node.on(cc.Node.EventType.MOUSE_LEAVE, this.onMouseLeave, this);\n            this.node.on(cc.Node.EventType.MOUSE_DOWN, this.onMouseDown, this);\n            this.node.on(cc.Node.EventType.MOUSE_UP, this.onMouseUp, this);\n        }\n\n        this.node.on('RESET', this.reset, this);\n    },\n\n    init({ name }, shortName, chessSize) {\n        this.node.chessName = shortName;\n        this.node.fullName = name;\n        this.label.string = shortName;\n\n        this.node.setContentSize(chessSize, chessSize);\n        this.sprite.node.setContentSize(chessSize, chessSize);\n    },\n\n    onMouseEnter() {\n        if (this.isSelected) return;\n        if (this._tweenUnselect) this._tweenUnselect.stop();\n        if (!this._tweenSelect) {\n            this._tweenSelect = cc.tween(this.sprite.node)\n                .to(CONFIG.TWEEN_TIME, { scale: CONFIG.SELECT_SCALE })\n        }\n        this._tweenSelect.start();\n    },\n\n    onMouseLeave() {\n        if (this.isSelected) return;\n        if (this._tweenSelect) this._tweenSelect.stop();\n        if (!this._tweenUnselect) {\n            this._tweenUnselect = cc.tween(this.sprite.node)\n                .to(CONFIG.TWEEN_TIME, { scale: CONFIG.DESELECT_SCALE })\n        }\n        this._tweenUnselect.start();\n    },\n\n    onMouseDown() {\n        if (this.isSelected) {\n            this.isSelected = false;\n            this.onMouseLeave();\n            const unselectEvent = new cc.Event.EventCustom('CHESS_UNSELECT', true);\n\n            this.node.dispatchEvent(unselectEvent);\n            return;\n        }\n        if (!this._tweenHighlight) {\n            this._tweenHighlight = cc.tween(this.sprite.node)\n                .to(CONFIG.TWEEN_TIME / 2, { scale: CONFIG.DESELECT_SCALE })\n                .to(CONFIG.TWEEN_TIME / 2, { scale: CONFIG.SELECT_SCALE })\n        }\n        this._tweenHighlight.start();\n        this.isSelected = true;\n    },\n\n    onMouseUp() {\n        if (!this.isSelected) return;\n        const selectEvent = new cc.Event.EventCustom('CHESS_SELECT', true);\n        selectEvent.chessName = this.node.chessName;\n        selectEvent.side = this.node.parent.name === 'Top_side' ? 'top' : 'bot';\n\n        this.node.dispatchEvent(selectEvent);\n    },\n\n    reset() {\n        this.isSelected = null;\n        this._tweenUnselect.start();\n    }\n});\n"]}