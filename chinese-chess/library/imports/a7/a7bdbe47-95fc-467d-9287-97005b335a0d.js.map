{"version":3,"sources":["../../../../assets/core/assets/core/ChessPiece.js"],"names":["require","init","CONFIG","TWEEN_TIME","SELECT_SCALE","DESELECT_SCALE","cc","Class","extends","Component","properties","sprite","Sprite","label","Label","onLoad","node","bind","on","Node","EventType","MOUSE_ENTER","onMouseEnter","MOUSE_LEAVE","onMouseLeave","MOUSE_DOWN","onMouseDown","MOUSE_UP","onMouseUp","shortName","chessSize","name","chessName","fullName","string","setContentSize","_tweenUnselect","stop","_tweenSelect","tween","to","scale","start","isSelected","_tweenHighlight","selectEvent","Event","EventCustom","side","parent","scheduleOnce","dispatchEvent"],"mappings":"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","file":"ChessPiece.js","sourceRoot":"../../../../assets/core","sourcesContent":["const { init } = require(\"events\");\n\nconst CONFIG = {\n    TWEEN_TIME: 0.2,\n    SELECT_SCALE: 1.3,\n    DESELECT_SCALE: 1,\n};\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        sprite: cc.Sprite,\n        label: cc.Label,\n    },\n\n    onLoad() {\n        this.node.init = this.init.bind(this);\n        this.node.sprite = this.sprite.node;\n\n        if (this.node) {\n            this.node.on(cc.Node.EventType.MOUSE_ENTER, this.onMouseEnter, this);\n            this.node.on(cc.Node.EventType.MOUSE_LEAVE, this.onMouseLeave, this);\n            this.node.on(cc.Node.EventType.MOUSE_DOWN, this.onMouseDown, this);\n            this.node.on(cc.Node.EventType.MOUSE_UP, this.onMouseUp, this);\n        }\n    },\n\n    init({ name }, shortName, chessSize) {\n        this.node.chessName = shortName;\n        this.node.fullName = name;\n        this.label.string = shortName;\n\n        this.node.setContentSize(chessSize, chessSize);\n        this.sprite.node.setContentSize(chessSize, chessSize);\n    },\n\n    onMouseEnter() {\n        if (this._tweenUnselect) this._tweenUnselect.stop();\n        if (!this._tweenSelect) {\n            this._tweenSelect = cc.tween(this.sprite.node)\n                .to(CONFIG.TWEEN_TIME, { scale: CONFIG.SELECT_SCALE })\n        }\n        this._tweenSelect.start();\n    },\n\n    onMouseLeave() {\n        if (this.isSelected) return;\n        if (this._tweenSelect) this._tweenSelect.stop();\n        if (!this._tweenUnselect) {\n            this._tweenUnselect = cc.tween(this.sprite.node)\n                .to(CONFIG.TWEEN_TIME, { scale: CONFIG.DESELECT_SCALE })\n        }\n        this._tweenUnselect.start();\n    },\n\n    onMouseDown() {\n        if (this.isSelected) {\n            this.isSelected = false;\n            this.onMouseLeave();\n            return;\n        }\n        if (!this._tweenHighlight) {\n            this._tweenHighlight = cc.tween(this.sprite.node)\n                .to(CONFIG.TWEEN_TIME / 2, { scale: CONFIG.DESELECT_SCALE })\n                .to(CONFIG.TWEEN_TIME / 2, { scale: CONFIG.SELECT_SCALE })\n        }\n        this._tweenHighlight.start();\n        this.isSelected = true;\n    },\n\n    onMouseUp() {\n        if (!this.isSelected) return;\n        const selectEvent = new cc.Event.EventCustom('CHESS_SELECT', true);\n        selectEvent.chessName = this.node.chessName;\n        selectEvent.side = this.node.parent.name === 'Top_side' ? 'top' : 'bot';\n        this.scheduleOnce(() => {\n            this.node.dispatchEvent(selectEvent);\n        }, 0.5);\n    },\n});\n"]}